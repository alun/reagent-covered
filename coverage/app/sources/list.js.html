<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for app/sources/list.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">app/sources/</a> list.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>33/33</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>5/5</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>6/6</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>33/33</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// Compiled by ClojureScript 1.9.293 {}
goog.provide('app.sources.list');
goog.require('cljs.core');
goog.require('clojure.string');
goog.require('app.css');
goog.require('reagent.core');
goog.require('cljsjs.codemirror');
goog.require('cljsjs.codemirror.mode.clojure');
app.css.load.call(null,new cljs.core.Keyword("app.sources.list","styles","app.sources.list/styles",2067255736),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"vendors","vendors",-153040496),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["webkit","moz"], null)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,".editor",".editor",2032871892),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"border","border",1444987323),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"1px","1px",-346533069),new cljs.core.Keyword(null,"solid","solid",-2023773691),new cljs.core.Keyword(null,"black","black",1294279647)], null)], null),new cljs.core.Keyword(null,"width","width",-384071477),new cljs.core.Keyword(null,"800px","800px",135162514)], null),cljs.core.with_meta(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"box-shadow","box-shadow",1600206755),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"10px","10px",-859606082),new cljs.core.Keyword(null,"10px","10px",-859606082),new cljs.core.Keyword(null,"12px","12px",1954728562),new cljs.core.Keyword(null,"-8px","-8px",847567888),"rgba(0, 0, 0, 0.75)"], null)], null)], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"prefix","prefix",-265908465),true], null))], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,".file",".file",-1014167652),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"color","color",1011675173),new cljs.core.Keyword(null,"#ddd","#ddd",-1886570548)], null)], null));
app.sources.list.__GT_id = (function app$sources$list$__GT_id(path){
return clojure.string.replace.call(null,path,/[\/ .]/,"_");
});
app.sources.list.bind_editor_BANG_ = (function app$sources$list$bind_editor_BANG_(this$){
var node = reagent.core.dom_node.call(null,this$);
var vec__35188 = this$.props.argv;
var _ = cljs.core.nth.call(null,vec__35188,(0),null);
var code = cljs.core.nth.call(null,vec__35188,(1),null);
return this$.editor = CodeMirror(node,cljs.core.clj__GT_js.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"value","value",305978217),code,new cljs.core.Keyword(null,"mode","mode",654403691),"clojure",new cljs.core.Keyword(null,"lineNumbers","lineNumbers",1374890941),true,new cljs.core.Keyword(null,"readOnly","readOnly",-1749118317),true], null)));
});
app.sources.list.editor = cljs.core.with_meta.call(null,(function (code){
return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.editor","div.editor",-1423342585)], null);
}),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"component-did-mount","component-did-mount",-1126910518),app.sources.list.bind_editor_BANG_], null));
app.sources.list.coverage_link = (function app$sources$list$coverage_link(path){
if((clojure.string.ends_with_QMARK_.call(null,path,".cljs")) &amp;&amp; (cljs.core.not.call(null,cljs.core.re_find.call(null,/_test/,path))) &amp;&amp; (cljs.core.not.call(null,cljs.core.re_find.call(null,/main\./,path)))){
var link = clojure.string.join.call(null,"/",cljs.core.concat.call(null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["coverage"], null),cljs.core.drop.call(null,(1),clojure.string.split.call(null,path,"/"))));
var link__$1 = clojure.string.replace.call(null,link,/\.cljs/,".js.html");
return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",-2123407586),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",-793805698),link__$1], null),"coverage"], null);
} else {
return null;
}
});
app.sources.list.render_source = (function app$sources$list$render_source(p__35191){
var vec__35195 = p__35191;
var path = cljs.core.nth.call(null,vec__35195,(0),null);
var code = cljs.core.nth.call(null,vec__35195,(1),null);
var id = app.sources.list.__GT_id.call(null,path);
return new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"key","key",-1516042587),id], null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2.file","h2.file",268815757),path," ",new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [app.sources.list.coverage_link,path], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [app.sources.list.editor,code], null)], null);
});
app.sources.list.component = (function app$sources$list$component(){
var sources = cljs.core.PersistentHashMap.fromArrays(["src/app/sources/loader.clj","test/app/view_test.cljs","test/app/css_test.cljs","src/app/utils.cljs","test/starter/doo.cljs","test/app/utils_test.cljs","src/app/view.cljs","src/bootstrap/main.cljs","src/app/sources/list.cljs","src/app/css.cljs"],["(ns app.sources.loader\n  (:require [me.raynes.fs :as fs]\n            [clojure.string :as s]))\n\n(defn -&gt;path\n  [file]\n  (.getPath file))\n\n(defn base-pattern\n  []\n  (-&gt; fs/*cwd*\n      -&gt;path\n      s/re-quote-replacement\n      re-pattern))\n\n(defn relativize\n  [file]\n  (let [base (base-pattern)\n        path (-&gt;path file)]\n    (-&gt;&gt; (s/replace-first path base \"\")\n         rest\n         (apply str))))\n\n(defn list-sources\n  []\n  (into []\n        (map relativize)\n        (concat\n          (fs/find-files \"src\" #\".*\\.cljs?$\")\n          (fs/find-files \"test\" #\".*\\.cljs?$\")\n          )))\n\n(defn -&gt;name-content\n  [name]\n  [name (slurp name)])\n\n(defmacro load-sources\n  []\n  (into {}\n        (map -&gt;name-content)\n        (list-sources)))\n","(ns app.view-test\n  (:require\n    [cljs.test :refer-macros [deftest is testing]]\n    [reagent.core :as r]\n    [app.view :as view]\n    [app.utils :as utils]\n    ))\n\n(deftest it-renders\n  (let [container (utils/create-lazy-container \"test\")]\n    (r/render-component [view/component] container)\n    (r/unmount-component-at-node container)))\n\n","(ns app.css-test\n  (:import goog.dom.query)\n  (:require\n    [cljs.test :refer-macros [deftest is testing]]\n    [app.css :as css]\n    ))\n\n(defn elems\n  [query]\n  (-&gt; (goog.dom.query query)\n      js/Array.from\n      seq))\n\n(deftest load\n  (let [n (count (elems \"link\"))]\n    (css/load ::styles [[:body {:width 0 :height 0}]])\n    (is (= (inc n) (count (elems \"link\"))))\n    (css/load ::styles [[:body {:width 0 :height 0}]])\n    (is (= (inc n) (count (elems \"link\"))))\n    ))\n","(ns app.utils\n  (:import goog.crypt.base64)\n  )\n\n(defn rand-num\n  ([amp suff]\n   (let [v (-&gt;&gt; (.random js/Math) (* amp) (.trunc js/Math))]\n     (if suff\n       (str v suff)\n       v)))\n  ([amp] (rand-num amp nil)))\n\n(defn create-lazy-container\n  [id]\n  (let [body (.-body js/document)\n        div (or (.getElementById js/document id)\n                (-&gt;&gt; \"div\"\n                     (.createElement js/document)\n                     (.appendChild body)))]\n    (set! (.-id div) id)\n    div))\n\n(defn color [r g b]\n  (str \"rgb(\" r \",\" g \",\" b \")\"))\n\n(defn random-color []\n  (color (rand-num 255) (rand-num 255) (rand-num 255)))\n\n(defn log [&amp; args]\n  (.apply (.-log js/console) js/console (clj-&gt;js args)))\n\n(defn -&gt;camel-case\n  \"Converts kebab case to camel case\"\n  [v]\n  (clojure.string/replace v #\"-(\\w)\"\n                          #(clojure.string/upper-case (second %))))\n\n(defn -&gt;base64\n  \"Converts value to base64\"\n  [value]\n  (js/goog.crypt.base64.encodeString value))\n","(ns starter.doo\n  (:require\n    [doo.runner :refer-macros [doo-all-tests doo-tests]]\n    [app.view-test]\n    [app.utils-test]\n    [app.css-test]\n    ))\n\n(doo-all-tests #\"app\\..*(?:-test)$\")\n\n","(ns app.utils-test\n  (:require\n    [cljs.test :refer-macros [deftest is testing]]\n    [clj-di.test :refer-macros [with-reset]]\n    [app.utils :as utils]\n    ))\n\n(deftest rand-num\n  (testing \"just random\"\n    (let [r (utils/rand-num 100)]\n      (is (number? r))\n      ))\n  (testing \"with a suffix\"\n    (let [r (utils/rand-num 100 \"px\")]\n      (is (.endsWith r \"px\"))\n      ))\n  (testing \"arity\"\n    (try\n      (utils/rand-num)\n      (catch js/Object e (utils/log (.-message e)))\n      )))\n\n(deftest log\n  (let [calls (atom [])\n        mock (clj-&gt;js\n               {:log (fn [&amp; args] (swap! calls conj args))})\n        ]\n    (with-reset [js/console mock]\n      (utils/log \"bla\" \"bla\" \"bla\")\n      (is (= (first @calls) [\"bla\" \"bla\" \"bla\"]))\n      (apply utils/log [\"and\" \"bla\"])\n      (is (= (last @calls) [\"and\" \"bla\"]))\n      ;; and try with no args\n      (utils/log)\n      )))\n\n(deftest create-lazy-container\n  (let [elem (utils/create-lazy-container \"some\")]\n    (is (not (nil? elem)))\n    (is (= elem (utils/create-lazy-container \"some\")))\n    ))\n\n(deftest random-color\n  (let [c (utils/random-color)\n        matches (re-seq #\"rgb\\((\\d+),(\\d+),(\\d+)\\)\" c)\n        [_ r g b] (first matches)]\n    (doseq [c [r g b]]\n      (is (number? (js/parseInt c)))\n      )))\n\n(deftest -&gt;camel-case\n  (is (=\n    (utils/-&gt;camel-case \"some-thing--here\")\n    \"someThing-Here\")))\n\n","(ns app.view\n  (:import goog.dom.classlist)\n  (:require [reagent.core :as r]\n            [app.css :as css]\n            [app.sources.list :as list]\n            [app.utils :refer [random-color log rand-num]]))\n\n(css/load ::styles\n          [:body {:padding 0\n                  :margin 0\n                  :font-family \"monospace\"\n                  :background \"url(http://api.thumbr.it/whitenoise-361x370.png?background=4ea6caff&amp;noise=626262&amp;density=36&amp;opacity=15)\"\n                  }]\n          [:html :body {:width \"100%\"\n                        :height \"100%\"\n                        }]\n           )\n\n(defn component []\n  [:div.container [list/component]])\n\n","(ns bootstrap.main\n  (:require [reagent.core :as r]\n            [app.utils :refer [create-lazy-container]]\n            [app.view :refer [component]]))\n\n(let [container (create-lazy-container \"app\")]\n  (r/render-component [component] container))\n","(ns app.sources.list\n  \"A component refleting project source and test files to the Web UI\"\n  (:require-macros [app.sources.loader :refer [load-sources]])\n  (:require [clojure.string :as s]\n            [app.css :as css]\n            [reagent.core :as r]\n            [cljsjs.codemirror]\n            [cljsjs.codemirror.mode.clojure]))\n\n(css/load ::styles\n          {:vendors [\"webkit\", \"moz\"]}\n          [:.editor {:border [[:1px :solid :black]]\n                     :width :800px}\n           ^:prefix {:box-shadow [[:10px :10px :12px :-8px \"rgba(0, 0, 0, 0.75)\"]]}\n           ]\n          [:.file {:color :#ddd}]\n          )\n\n(defn -&gt;id\n  [path]\n  (s/replace path #\"[/ .]\" \"_\"))\n\n;; Editor\n\n(defn bind-editor!\n  [this]\n  (let [node (r/dom-node this)\n        [_ code] (-&gt; this .-props .-argv)]\n    (set! (.-editor this)\n          (js/CodeMirror node\n                         (clj-&gt;js {:value code\n                                   :mode \"clojure\"\n                                   :lineNumbers true\n                                   :readOnly true})\n                         ))))\n\n(def editor\n  (with-meta\n    (fn [code] [:div.editor])\n    {:component-did-mount bind-editor!\n     }))\n\n;; Components\n\n(defn coverage-link\n  [path]\n  (when (and (s/ends-with? path \".cljs\")     ;; show coverage link only for\n             (not (re-find #\"_test\" path))   ;; non test clojurescript\n             (not (re-find #\"main\\.\" path))  ;; non main bootstrap fild\n             )\n    (let [link (-&gt;&gt; (s/split path \"/\")\n                    (drop 1)                 ;; drop src/ and test/\n                    (concat [\"coverage\"])    ;; add coverage prefix\n                    (s/join \"/\"))\n          link (s/replace link #\"\\.cljs\" \".js.html\")]\n      [:a {:href link} \"coverage\"])))\n\n(defn render-source\n  [[path code]]\n  (let [id (-&gt;id path)]\n    [:div {:key id}\n     [:h2.file path \" \" [coverage-link path]]\n     [editor code]]))\n\n(defn component\n  []\n  (let [sources (load-sources)]\n    [:div.file-list\n     (map render-source sources)]))\n","(ns app.css\n  (:require [app.utils :refer [-&gt;camel-case -&gt;base64]]\n            [garden.core :refer [css]]))\n\n(defonce ^:private elements (atom {}))\n\n(defn- elem\n  [name]\n  (.createElement js/document name))\n\n(defn- by-name\n  [name]\n  (into [] (js/Array.from\n             (js/document.getElementsByTagName name))))\n\n(defn- attr\n  [elem k value]\n  (doto elem\n    (.setAttribute (-&gt;camel-case (name k)) value)))\n\n(defn load\n  [k &amp; garden-css]\n  (let [base64 (-&gt;base64 (apply css garden-css))\n        href (str \"data:text/css;base64,\" base64)\n        head (first (by-name \"head\"))\n        link (-&gt; (elem \"link\")\n               (attr :type \"text/css\")\n               (attr :rel \"stylesheet\")\n               (attr :href href))\n        ]\n    (when-let [old-link (k @elements)]\n      (.removeChild head old-link))\n    (swap! elements assoc k link)\n    (.appendChild head link)\n    ))\n"]);
return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.file-list","div.file-list",1442410121),cljs.core.map.call(null,app.sources.list.render_source,sources)], null);
});
&nbsp;
//# sourceMappingURL=list.js.map?rel=1485129299012</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Jan 23 2017 23:48:17 GMT+0000 (GMT)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
